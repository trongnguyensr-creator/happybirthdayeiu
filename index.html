<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Happy Birthday, My Love ♡</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap');
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  touch-action: pan-y;
}
html, body{
  height:100%;
  font-family:'Quicksand',Arial,Helvetica,sans-serif;
  color:#222;
  background:radial-gradient(
    circle at 40% 30%,
    #fff7fa 0%,
    #ffe4ee 25%,
    #ffc1d6 50%,
    #ff9fbe 72%,
    #ff7aa8 100%
  );
  position:relative;
  overflow-x: hidden;
}
/* ===== FLOATING GLOW ===== */
.floating-glow{
  position:absolute;
  background:radial-gradient(
    circle at 40% 40%,
    rgba(255,255,255,0.95) 0%,
    rgba(255,220,235,0.75) 25%,
    rgba(255,180,210,0.55) 50%,
    rgba(255,160,200,0.35) 70%,
    transparent 90%
  );
  border-radius:50%;
  pointer-events:none;
  animation:floatGlow 34s ease-in-out infinite;
  will-change:transform,opacity;
  filter:blur(30px);
  mix-blend-mode:screen;
  z-index:1;
}
@keyframes floatGlow{
  0% {transform:translate(-50%,-50%) scale(0.7) rotate(0deg);opacity:0.35;}
  25% {transform:translate(-50%,-50%) scale(1.3) rotate(90deg);opacity:0.8;}
  50% {transform:translate(-50%,-50%) scale(1.8) rotate(180deg);opacity:1;}
  75% {transform:translate(-50%,-50%) scale(1.3) rotate(270deg);opacity:0.8;}
  100% {transform:translate(-50%,-50%) scale(0.7) rotate(360deg);opacity:0.35;}
}
.floating-glow:nth-child(1){--size:380px;left:10%;top:14%;animation-duration:40s;}
.floating-glow:nth-child(2){--size:460px;left:90%;top:20%;animation-duration:48s;}
.floating-glow:nth-child(3){--size:320px;left:35%;top:82%;animation-duration:30s;}
.floating-glow:nth-child(4){--size:520px;left:96%;top:6%; animation-duration:54s;}
.floating-glow:nth-child(5){--size:360px;left:6%; top:94%;animation-duration:36s;}
.floating-glow:nth-child(6){--size:420px;left:72%;top:62%;animation-duration:46s;}
.floating-glow:nth-child(7){--size:340px;left:55%;top:48%;animation-duration:32s;}
.floating-glow:nth-child(8){--size:400px;left:18%;top:70%;animation-duration:42s;}
.floating-glow{width:var(--size);height:var(--size);}
/* ===== SCENES ===== */
.scene{
  position:absolute;
  width:100%;
  height:100%;
  transition:opacity 1.2s ease-in-out, transform 1.2s ease-in-out;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  z-index:2;
}
.scene.active{
  opacity:1;
  pointer-events:auto;
}
/* ===== GLASS CARD ===== */
.glass{
  background:rgba(255,255,255,0.38);
  backdrop-filter:blur(24px);
  -webkit-backdrop-filter:blur(24px);
  border:2px solid rgba(255,255,255,0.55);
  border-radius:34px;
  padding:55px 65px;
  box-shadow:0 22px 65px rgba(0,0,0,0.18);
  text-align:center;
  color:#111;
  max-width:90%;
  cursor:pointer;
}
/* ===== COUNTDOWN ===== */
#countdown{
  font-weight:700;
  font-size:4.6rem;
  letter-spacing:12px;
  margin-bottom:25px;
  color:#fff;
  text-shadow:0 0 12px #ff9fc4, 0 0 28px #ffc1d6, 0 0 48px #ffe4ee;
  display:flex;
  align-items:center;
  gap:16px;
  justify-content:center;
}
.time-unit{
  min-width:120px;
  background:rgba(255,255,255,0.28);
  border-radius:20px;
  padding:14px 0;
  backdrop-filter:blur(12px);
  animation:pulseSoft 3.2s infinite ease-in-out;
}
@keyframes pulseSoft{
  0%,100%{transform:scale(1);}
  50%{transform:scale(1.06);}
}
/* ===== DATE ===== */
#date{
  font-size:2.4rem;
  font-weight:600;
  color:#fff;
  letter-spacing:6px;
  margin-top:18px;
  text-shadow:0 0 18px #ff9fc4, 0 0 36px #ffd1e2;
}
.date-glow{
  animation:dateMagic 1.6s ease-in-out;
}
@keyframes dateMagic{
  0% {transform:scale(1);opacity:1;text-shadow:0 0 32px #ffb3d1;}
  50% {transform:scale(1.35);opacity:0.35;text-shadow:0 0 80px #ffe4ee;}
  100% {transform:scale(1);opacity:1;text-shadow:0 0 32px #ffb3d1;}
}
/* ===== LOVE LETTER SCROLLABLE ===== */
#loveLetter {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 60px 20px 20px 20px;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.letter-container {
  max-width: 680px;
  width: 100%;
  background:rgba(255,255,255,0.38);
  backdrop-filter:blur(24px);
  -webkit-backdrop-filter:blur(24px);
  border:2px solid rgba(255,255,255,0.55);
  border-radius:34px;
  padding:50px 55px;
  box-shadow:0 22px 65px rgba(0,0,0,0.18);
  margin: 0 auto 40px auto;
  cursor: default;
  max-height: none;
}

.letter-header {
  text-align: center;
  font-size: 3rem;
  font-weight: 700;
  color: #d81b60;
  margin-bottom: 35px;
  text-shadow: 0 2px 12px rgba(216, 27, 96, 0.3);
}

#letterContent {
  font-size: 1.5rem;
  line-height: 1.9;
  color: #222;
  min-height: 300px;
  overflow-y: visible;
}

.letter-footer {
  text-align: right;
  margin-top: 40px;
  font-size: 1.6rem;
  font-weight: 600;
  color: #d81b60;
  font-style: italic;
}

/* Scroll indicator */
.scroll-indicator {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  opacity: 0.7;
  animation: fadeInOut 2s infinite;
  z-index: 10;
}

.scroll-text {
  font-size: 1.2rem;
  color: #ff6b9d;
  font-weight: 600;
}

.scroll-arrow {
  width: 24px;
  height: 24px;
  border-right: 3px solid #ff6b9d;
  border-bottom: 3px solid #ff6b9d;
  transform: rotate(45deg);
  animation: bounce 1.5s infinite;
}

@keyframes fadeInOut {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

@keyframes bounce {
  0%, 100% { transform: rotate(45deg) translateY(0); }
  50% { transform: rotate(45deg) translateY(10px); }
}

/* ===== MOBILE OPTIMIZATIONS ===== */
@media(max-width:768px){
  html, body {
    overflow-y: auto;
  }
  .glass {
    padding: 35px 45px;
    border-radius: 28px;
  }
  #countdown {
    font-size: 3.3rem;
    letter-spacing: 8px;
    gap: 12px;
  }
  .time-unit {
    min-width: 90px;
    padding: 10px 0;
    border-radius: 16px;
  }
  #date {
    font-size: 2rem;
    letter-spacing: 4px;
  }
  .letter-container {
    padding: 35px 30px;
    max-width: 95%;
    margin: 0 auto 30px auto;
  }
  .letter-header {
    font-size: 2.2rem;
    margin-bottom: 25px;
  }
  #letterContent {
    font-size: 1.3rem;
    line-height: 1.75;
  }
  .floating-glow {
    filter: blur(20px);
  }
  .floating-glow:nth-child(1){--size:280px;}
  .floating-glow:nth-child(2){--size:360px;}
  .floating-glow:nth-child(3){--size:220px;}
  .floating-glow:nth-child(4){--size:420px;}
  .floating-glow:nth-child(5){--size:260px;}
  .floating-glow:nth-child(6){--size:320px;}
  .floating-glow:nth-child(7){--size:240px;}
  .floating-glow:nth-child(8){--size:300px;}
}
/* Sparkle effect */
.sparkle {
  position: absolute;
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
  pointer-events: none;
  animation: sparkleAnim 1.4s ease-out forwards;
  box-shadow: 0 0 10px white, 0 0 20px #ff9fc4;
  z-index: 3;
}
@keyframes sparkleAnim {
  0% { transform: translate(0,0) scale(0); opacity: 1; }
  50% { transform: translate(var(--x), var(--y)) scale(1.8); opacity: 0.9; }
  100% { transform: translate(calc(var(--x)*1.6), calc(var(--y)*1.6)) scale(0); opacity: 0; }
}
</style>
</head>
<body>
<!-- Floating glows -->
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>
<div class="floating-glow"></div>

<!-- Initial Screen -->
<div id="initialScreen" class="scene active">
  <div class="glass" id="startButton">
    <div style="font-size: 2.8rem; font-weight: 700; color: #fff; text-shadow: 0 0 20px #ff9fc4, 0 0 40px #ffc1d6; animation: pulseSoft 2s infinite ease-in-out;">
      NHẤN VÀO MÀN HÌNH
    </div>
    <div style="font-size: 1.6rem; font-weight: 500; color: #fff; margin-top: 20px; opacity: 0.85;">
      để bắt đầu ♡
    </div>
  </div>
</div>

<!-- Countdown Screen -->
<div id="scene1" class="scene">
  <div class="glass">
    <div id="countdown">
      <span class="time-unit" id="hh">23</span>:
      <span class="time-unit" id="mm">59</span>:
      <span class="time-unit" id="ss">55</span>
    </div>
    <div id="date">12/02/2026</div>
  </div>
</div>

<!-- Love Letter Screen -->
<div id="scene2" class="scene">
  <div id="loveLetter">
    <div class="letter-container">
      <div class="letter-header">Gửi Em Yêu ♡</div>
      <div id="letterContent"></div>
      <div class="letter-footer">- Yêu em mãi mãi -</div>
    </div>
    <div class="scroll-indicator">
      <div class="scroll-text">Vuốt để đọc tiếp</div>
      <div class="scroll-arrow"></div>
    </div>
  </div>
</div>

<!-- Music -->
<audio id="bgMusic" loop>
  <!-- Add your music file here -->
  <!-- <source src="hpbd.mp3" type="audio/mpeg"> -->
</audio>

<script>
// DOM Elements
const initialScreen = document.getElementById('initialScreen');
const scene1 = document.getElementById('scene1');
const scene2 = document.getElementById('scene2');
const startButton = document.getElementById('startButton');
const hh = document.getElementById('hh');
const mm = document.getElementById('mm');
const ss = document.getElementById('ss');
const dateEl = document.getElementById('date');
const letterContent = document.getElementById('letterContent');
const bgMusic = document.getElementById('bgMusic');
const scrollIndicator = document.querySelector('.scroll-indicator');

// Countdown variables
let hours = 23;
let minutes = 59;
let seconds = 55;
let countdownTimer = null;
let isStarted = false;

// Touch/swipe variables
let touchStartY = 0;
let touchEndY = 0;
let letterTyped = false;

// Love letter text
const letterText = `Em yêu của anh,

Hôm nay là một ngày đặc biệt, một ngày mà anh muốn dành tất cả những lời yêu thương nhất, những cảm xúc chân thành nhất để gửi đến em.

Từ lần đầu tiên gặp em, cuộc đời anh như được thêm ánh sáng, được thêm ý nghĩa. Nụ cười của em là động lực mỗi ngày, ánh mắt em là nơi anh tìm thấy bình yên.

Mỗi khoảnh khắc bên em đều là món quà quý giá mà anh không bao giờ muốn đánh mất. Em đã làm cho thế giới của anh trở nên tươi đẹp hơn, ấm áp hơn và đầy yêu thương hơn.

Sinh nhật vui vẻ em nhé! Anh chúc em luôn tươi cười, luôn khỏe mạnh, và luôn hạnh phúc. Anh hứa sẽ mãi ở bên em, cùng em trải qua mọi khoảnh khắc trong cuộc đời.

Anh yêu em nhiều lắm!

Cảm ơn em đã đến bên anh, cảm ơn em vì tất cả. Mỗi ngày bên em đều là một món quà mà anh trân trọng vô cùng.

Chúc em một sinh nhật thật ấm áp, thật hạnh phúc và tràn ngập yêu thương. Mong rằng mọi điều tốt đẹp nhất sẽ đến với em trong tuổi mới này.

Mãi yêu em...`;

// Helper functions
function padNumber(num) {
  return num < 10 ? '0' + num : num.toString();
}

function updateCountdownDisplay() {
  hh.textContent = padNumber(hours);
  mm.textContent = padNumber(minutes);
  ss.textContent = padNumber(seconds);
}

function createSparkle(x, y) {
  const sparkle = document.createElement('div');
  sparkle.className = 'sparkle';
  sparkle.style.left = x + 'px';
  sparkle.style.top = y + 'px';
  
  const angle = Math.random() * Math.PI * 2;
  const distance = 50 + Math.random() * 100;
  const xOffset = Math.cos(angle) * distance;
  const yOffset = Math.sin(angle) * distance;
  
  sparkle.style.setProperty('--x', xOffset + 'px');
  sparkle.style.setProperty('--y', yOffset + 'px');
  
  document.body.appendChild(sparkle);
  setTimeout(() => {
    if (sparkle.parentNode) {
      sparkle.parentNode.removeChild(sparkle);
    }
  }, 1400);
}

function updateCountdown() {
  seconds++;
  
  if (seconds >= 60) {
    seconds = 0;
    minutes++;
  }
  
  if (minutes >= 60) {
    minutes = 0;
    hours++;
  }
  
  if (hours >= 24) {
    hours = 0;
  }
  
  updateCountdownDisplay();
  
  // Check if countdown reaches 00:00:00
  // Note: Starting from 23:59:55, after 5 seconds it will be 00:00:00
  if (hours === 0 && minutes === 0 && seconds === 0) {
    clearInterval(countdownTimer);
    celebrateBirthday();
    return;
  }
}

function celebrateBirthday() {
  // Update date with animation
  dateEl.textContent = '13/02/2026';
  dateEl.classList.add('date-glow');
  
  // Create sparkles
  const rect = dateEl.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;
  
  for (let i = 0; i < 25; i++) {
    setTimeout(() => {
      createSparkle(centerX, centerY);
    }, i * 50);
  }
  
  // Transition to love letter after delay
  setTimeout(() => {
    scene1.classList.remove('active');
    
    setTimeout(() => {
      scene2.classList.add('active');
      
      // Start typing the letter
      typeWriter(letterContent, letterText, 30);
    }, 800);
  }, 2800);
}

function typeWriter(element, text, speed = 30) {
  let i = 0;
  element.innerHTML = '';
  letterTyped = false;
  
  function type() {
    if (i < text.length) {
      if (text.charAt(i) === '\n') {
        element.innerHTML += '<br>';
      } else {
        element.innerHTML += text.charAt(i);
      }
      i++;
      setTimeout(type, speed);
    } else {
      letterTyped = true;
      // Hide scroll indicator after typing is complete
      setTimeout(() => {
        scrollIndicator.style.opacity = '0';
        setTimeout(() => {
          scrollIndicator.style.display = 'none';
        }, 500);
      }, 2000);
    }
  }
  
  type();
}

function startApplication() {
  if (isStarted) return;
  isStarted = true;
  
  console.log("Ứng dụng bắt đầu!");
  
  // Try to play background music
  bgMusic.volume = 0.4;
  bgMusic.play().catch(error => {
    console.log("Không thể phát nhạc tự động, cần tương tác người dùng");
  });
  
  // Hide initial screen
  initialScreen.classList.remove('active');
  
  // Show countdown screen
  setTimeout(() => {
    scene1.classList.add('active');
    
    // Initialize countdown display
    updateCountdownDisplay();
    
    // Start countdown timer (counting UP from 23:59:55 to 00:00:00)
    countdownTimer = setInterval(updateCountdown, 1000);
  }, 500);
}

// Touch/swipe handlers
function handleTouchStart(e) {
  if (scene2.classList.contains('active')) {
    const loveLetter = document.getElementById('loveLetter');
    touchStartY = e.touches[0].clientY;
  }
}

function handleTouchMove(e) {
  // Allow natural scrolling in the love letter scene
  if (scene2.classList.contains('active')) {
    // Don't prevent default - allow natural scroll
    return;
  }
}

function handleTouchEnd(e) {
  if (scene2.classList.contains('active')) {
    touchEndY = e.changedTouches[0].clientY;
  }
}

function handleSwipe() {
  // Remove swipe handling - use native scroll instead
}

function scrollToBottom() {
  const loveLetter = document.getElementById('loveLetter');
  loveLetter.scrollTo({
    top: loveLetter.scrollHeight,
    behavior: 'smooth'
  });
}

function scrollToTop() {
  const loveLetter = document.getElementById('loveLetter');
  loveLetter.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
}

// Mouse wheel handler for desktop
function handleWheel(e) {
  // Allow natural scrolling in love letter scene
  return;
}

// Initialize
updateCountdownDisplay();

// Event Listeners
startButton.addEventListener('click', startApplication);
initialScreen.addEventListener('click', function(e) {
  if (e.target !== startButton) {
    startApplication();
  }
});

// Touch events for mobile
document.addEventListener('touchstart', handleTouchStart, { passive: true });
document.addEventListener('touchmove', handleTouchMove, { passive: false });
document.addEventListener('touchend', handleTouchEnd, { passive: true });

// Wheel event for desktop
document.addEventListener('wheel', handleWheel, { passive: false });

// Click on scroll indicator
scrollIndicator.addEventListener('click', () => {
  scrollToBottom();
});

// For testing: Skip to birthday celebration
document.addEventListener('keydown', function(e) {
  if (e.key === 't' || e.key === 'T') {
    // Stop current countdown
    if (countdownTimer) {
      clearInterval(countdownTimer);
    }
    
    // Set to 23:59:59 (last second before birthday)
    hours = 23;
    minutes = 59;
    seconds = 59;
    updateCountdownDisplay();
    
    // Start from scene1 if not started
    if (!isStarted) {
      initialScreen.classList.remove('active');
      scene1.classList.add('active');
      isStarted = true;
    }
    
    console.log("Test mode: Countdown set to 23:59:59");
  }
  
  // Skip directly to birthday
  if (e.key === 'b' || e.key === 'B') {
    // Stop current countdown
    if (countdownTimer) {
      clearInterval(countdownTimer);
    }
    
    // Show scene1 if not shown
    if (!isStarted) {
      initialScreen.classList.remove('active');
      scene1.classList.add('active');
      isStarted = true;
    }
    
    // Trigger birthday celebration immediately
    hours = 23;
    minutes = 59;
    seconds = 59;
    updateCountdownDisplay();
    // Wait 1 second then trigger birthday
    setTimeout(() => {
      updateCountdown(); // This will make it 00:00:00
      updateCountdownDisplay();
      celebrateBirthday();
    }, 100);
    
    console.log("Test mode: Skipped to birthday celebration");
  }
});

// Auto-hide scroll indicator when user scrolls
const loveLetter = document.getElementById('loveLetter');
if (loveLetter) {
  loveLetter.addEventListener('scroll', () => {
    if (loveLetter.scrollTop > 50) {
      scrollIndicator.style.opacity = '0';
      setTimeout(() => {
        scrollIndicator.style.display = 'none';
      }, 300);
    }
  });
}

console.log("Trang đã sẵn sàng!");
console.log("Nhấn vào màn hình để bắt đầu");
console.log("Countdown sẽ đếm TĂNG từ 23:59:55 lên 00:00:00");
console.log("Nhấn 'T' để đặt countdown về 23:59:59");
console.log("Nhấn 'B' để skip thẳng đến sinh nhật");
</script>
</body>
</html>
